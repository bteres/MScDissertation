% -*- pdf: BrettTerespolskyMScDissertation.pdf -*-
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thesis
% LaTeX Template
% Version 1.4 (30/6/13)
%
% This template has been downloaded from:
% http://www.latextemplates.com
%
% Original authors:
% Steven Gunn
% http://users.ecs.soton.ac.uk/srg/softwaretools/document/templates/
% and
% Sunil Patel
% http://www.sunilpatel.co.uk/thesis-template/
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
% Note:
% Make sure to edit document variables in the Thesis.cls file
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[11pt, a4paper, oneside]{Thesis} % Paper size, default font size and one-sided paper
\usepackage{etex}
\usepackage{multirow}

\newcommand{\specialcellc}[2][c]{%
  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}
\newcommand{\specialcelll}[2][c]{%
  \begin{tabular}[#1]{@{}l@{}}#2\end{tabular}}
\newcommand{\specialcellr}[2][c]{%
  \begin{tabular}[#1]{@{}r@{}}#2\end{tabular}}

\graphicspath{{./Figures/}} % Specifies the directory where pictures are stored

\usepackage[square, numbers, comma, sort&compress]{natbib} % Use the natbib reference package - read up on this to edit the reference style; if you want text (e.g. Smith et al., 2012) for the in-text references (instead of numbers), remove 'numbers'
\usepackage{har2nat}
\makeatletter
\def\@mb@citenamelist{cite,citep,citet,citealp,citealt}
\makeatother
\usepackage{multibib}
\newcites{bib}{Bibliography}
\renewcommand{\bibname}{References}
\usepackage{tocbibind}
\usepackage[inline]{trackchanges}
% trackchanges package options:
% finalold  - Reject all edits. Refrain from using this.
% finalnew  - Accept all edits. Refrain from using this.
% The above two options should not be used, rather the trackchanges.py application must be used. Alternatively there is the acceptchanges.py for the terminal but check options carefully
% footnotes - Display edits as footnotes.
% margins   - Display edits as margin notes.
% inline    - Display edits inline.
\addeditor{KJN}
\addeditor{BRT}
% Usage of trackchanges below
% \add[editor]{added text}
% \remove[editor]{removed text}
% \change[editor]{removed text}{added text}
% \note[editor]{note text}
% \annote[editor]{text to annotate}{note text}
\makeatletter
\def\input@path{{./Primitives/}}
\makeatother
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{circuitikz}
\pgfplotsset{compat=1.10}
\usetikzlibrary{shapes.geometric, intersections,arrows}
\usepgfplotslibrary{external}
\usetikzlibrary{matrix}
\usepgfplotslibrary{groupplots}
\usepackage{pdfpages}
\tikzexternalize[prefix=TikzFigures/,shell escape=-enable-write18,optimize command away=\includepdf] %  activate!

\usepackage[toc, acronym, nonumberlist, nopostdot]{glossaries}
\newglossarystyle{mylong}{
\glossarystyle{long}
    \renewenvironment{theglossary}%
        {\begin{longtable}{p{0.35\linewidth}p{0.6\linewidth}}}%
        {\end{longtable}}%
    \renewcommand*{\glossaryentryfield}[5]{%
        \glsentryitem{##1}\glstarget{##1}{##2} & ##3\glspostdescription\space ##5\\[7.5pt]}%
}
\glossarystyle{mylong}
\renewcommand{\glsnamefont}[1]{\textbf{#1}}

\makeglossaries

\usepackage{breqn}

\usepackage{Extras}

\hypersetup{urlcolor=blue, colorlinks=false} % Colors hyperlinks in blue - change to black if annoying
\title{\ttitle} % Defines the thesis title - don't touch this

%----------------------------------------------------------------------------------------
%	Allow Russian alphabet from english letters. Just type \textcry{...}
%----------------------------------------------------------------------------------------
\usepackage[OT2,T1]{fontenc}
\newcommand\textcyr[1]{{\fontencoding{OT2}\fontfamily{wncyr}\selectfont #1}}
\def\Eoborotnoye{\char3}
\def\eoborotnoye{\char11}
\def\cprime{\char126}
\def\cdprime{\char127}

\input{AdditionalFiles/acronyms.tex}
\input{AdditionalFiles/nomenclature.tex}
\glsaddall

\begin{document}

\frontmatter % Use roman page numbering style (i, ii, iii, iv...) for the pre-content pages

\setstretch{1.3} % Line spacing of 1.3

% Define the page headers using the FancyHdr package and set up for one-sided printing
\fancyhead{} % Clears all page headers and footers
\rhead{\thepage} % Sets the right side header to show the page number
\lhead{} % Clears the left side page header

\pagestyle{fancy} % Finally, use the "fancy" page style to implement the FancyHdr headers

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % New command to make the lines in the title page

% PDF meta-data
\hypersetup{pdftitle={\ttitle}}
\hypersetup{pdfsubject=\subjectname}
\hypersetup{pdfauthor=\authornames}
\hypersetup{pdfkeywords=\keywordnames}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\maketitle

%----------------------------------------------------------------------------------------
%	DECLARATION PAGE
%	Your institution may give you a different text to place here
%----------------------------------------------------------------------------------------

\Declaration{

\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics

I, \authornames, declare that this dissertation titled, `\ttitle'  is my own unaided work. It is being submitted to the Degree of Master of Science to the University of the Witwatersrand, Johannesburg. It has not been submitted before for any degree or examination to any other University.

\vfill

Signed:\\
\rule[1em]{25em}{0.5pt} % This prints a line for the signature

Date:\\
\rule[1em]{25em}{0.5pt} % This prints a line to write the date
}

\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	QUOTATION PAGE
%----------------------------------------------------------------------------------------

\pagestyle{empty} % No headers or footers for the following pages

\null\vfill % Add some space to move the quote down the page a bit

\textit{``Give me six hours to chop down a tree and I will spend the first four sharpening the axe."}

\begin{flushright}
Abraham Lincoln
\end{flushright}

\vfill\vfill\vfill\vfill\vfill\vfill\null % Add some space at the bottom to position the quote just right

\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	ABSTRACT PAGE
%----------------------------------------------------------------------------------------

\addtotoc{Abstract} % Add the "Abstract" page entry to the Contents

\abstract{\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics

The work presented contributes to research in lightning protection simulations and focuses on approximating the Heidler function with an analytical integral and hence a frequency domain representation. The integral of lightning current models is required in the analysis of lightning events including the induced effects and frequency analyses of lightning strikes. Previous work in this area has produced very specific forms of the Heidler function that are used to represent lightning current waveshapes. This work however focuses on a generic solution with parameters that can be modified to produce any lightning current waveshape that is required. In the research presented, such an approximation is obtained. This function has an analytical solution to the integral and hence can be completely represented in the frequency domain. This allows for a true representation of Maxwell's equations for \gls{em} fields and for an analytical frequency domain analysis. It has parameters that can be changed to obtain different waveshapes (10/350, 0.25/100, etc.). The characteristics of the approximation are compared with those of the Heidler function to ascertain whether or not the function is applicable for use with the lightning protection standard (IEC~62305-1). It is shown that the approximation does represent the same characteristics as those of the Heidler function and hence can be used in IEC~62305-1 standardised applications. This represents a valuable contribution to engineers working in the field of lightning protection, specifically simulation models.

\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------

\setstretch{1.3} % Reset the line-spacing to 1.3 for body text (if it has changed)

\acknowledgements{\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics

I would like to thank Professor Ken J. Nixon for all his guidance, advice and enthusiasm throughout the duration of this work. I would also like to thank Professor Ian R. Jandrell for his support.

Thank you to my colleagues in the High Voltage and Lightning EMC research group as well as the staff of the Genmin Laboratories for their encouragement and support.

Thanks to the staff and postgraduate students of the school of electrical and information engineering in particular Mr Carson McAfee, Mr Jacques Naud\'e, Professor Ivan Hofsajer and Ms Yu-Chieh (Jessie) Liu for their long conversations and advice.

Special thanks are extended to Professor Montaz Ali and Professor Anne Love for the advice regarding complicated mathematics.

The following organisations are gratefully acknowledged for funding and supporting the High Voltage and Lightning EMC Research Groups:
\begin{itemize}
    \item CBI-Electric for direct support and funding the Chair of Lightning at the University of the Witwatersrand.
    \item Eskom through the Tertiary Education Support Programme (TESP).
    \item The National Research Foundation (NRF).
    \item The Department of Trade and Industry (DTI) for Technology and Human Resources for Industry Programme (THRIP) funding.
\end{itemize}

Furthermore, I formally acknowledge the funding that I received from the following establishments over the years:
\begin{itemize}
    \item The National Research Foundation (NRF) (\textit{opinions expressed and conclusions arrived at in this thesis are my own and should not necessarily be attributed to the NRF}).
    \item The University Postgraduate Merit Award.
\end{itemize}

Last but not least, I am thankful to all my family and friends for their encouragement, patience and support (and to those that assisted in the pain-staking process of proof reading).
}
\clearpage % Start a new page

%----------------------------------------------------------------------------------------
%	LIST OF CONTENTS/FIGURES/TABLES PAGES
%----------------------------------------------------------------------------------------

\pagestyle{fancy} % The page style headers have been "empty" all this time, now use the "fancy" headers as defined before to bring them back

\lhead{\emph{Contents}} % Set the left side page header to "Contents"
\tableofcontents % Write out the Table of Contents

\clearpage
\lhead{\emph{List of Figures}} % Set the left side page header to "List of Figures"
\listoffigures % Write out the List of Figures

\clearpage
\lhead{\emph{List of Tables}} % Set the left side page header to "List of Tables"
\listoftables % Write out the List of Tables

%----------------------------------------------------------------------------------------
%	ABBREVIATIONS
%----------------------------------------------------------------------------------------

\clearpage % Start a new page

\setstretch{1.5} % Set the line spacing to 1.5, this makes the following tables easier to read

% \lhead{\emph{Abbreviations}} % Set the left side page header to "Abbreviations"
% \printglossary[type=\acronymtype, title=Abbreviations]

%----------------------------------------------------------------------------------------
%	PHYSICAL CONSTANTS/OTHER DEFINITIONS
%----------------------------------------------------------------------------------------

% \clearpage % Start a new page

% \lhead{\emph{Physical Constants}} % Set the left side page header to "Physical Constants"

% \listofconstants{lrcl} % Include a list of Physical Constants (a four column table)
% {
% Speed of Light & $c$ & $=$ & $2.997\ 924\ 58\times10^{8}\ \mbox{ms}^{-\mbox{s}}$ (exact)\\
% % Constant Name & Symbol & = & Constant Value (with units) \\
% }

%----------------------------------------------------------------------------------------
%	SYMBOLS
%----------------------------------------------------------------------------------------

\clearpage % Start a new page

\lhead{\emph{Symbols}} % Set the left side page header to "Symbols"

\listofnomenclature{lll} % Include a list of Symbols (a three column table)
{
% \textbf{Symbol} & \textbf{Description} & \textbf{Units} \\
% & & \\ % Gap
\multicolumn{3}{l}{\textbf{Electromagnetic Equations of a Lightning Stroke}} \\
$E_z \left( D, t \right)$ & Electric field & V/m \\
$B_{\phi} \left( D,t \right)$ & Magnetic field & T \\

& & \\ % Gap
\multicolumn{3}{l}{\textbf{Lightning Current Return Stroke Modelling}} \\
$i \left( z',t \right)$ & Lightning current return stroke model & A \\
$i \left( 0,t \right)$ & Lightning channel base current & A \\

& & \\ % Gap
\multicolumn{3}{l}{\textbf{Double Exponential Function}} \\
$i_e \left( t \right)$ & Double exponential lightning stroke current model & A \\
$I_0$ & Peak current & A \\
$A$ & Double exponential peak current correction &  \\
$\alpha$ & Double exponential decay time constant & 1/s \\
$\beta$ & Double exponential rise time constant & 1/s \\

& & \\ % Gap
\multicolumn{3}{l}{\textbf{Heidler Function}} \\
$i_h \left( t \right)$ & Heidler function lightning stroke current model & A \\
$\eta$ & Peak current correction &  \\
$\tau_1$ & Heidler rise time constant & s \\
$\tau_2$ & Decay time constant & s \\
$n_h$ & Heidler steepness factor & \\
$i'_h \left( t \right)$ & First time derivative of $i_h \left( t \right)$ & A/s \\
$x_h \left( t \right)$ & Heidler function rise time function &  \\
$y \left( t \right)$ & Decay function & \\

& & \\ % Gap
\multicolumn{3}{l}{\textbf{Heidler Function Approximation}} \\
$X_a \left( s \right)$ & Rise time function of the approximation (Laplace domain) &  \\
$x_a \left( t \right)$ & Rise time function of the approximation (time domain) &  \\
$i_a \left( t \right)$ & Approximated lightning stroke current model & A \\
$\omega_0$ & Rise time constant of the approximation & rad/s \\
$n_a$ & Steepness factor of the approximation & \\
$i'_a \left( t \right)$ & First time derivative of $i_a \left( t \right)$ & A/s \\
$I_a \left( j\omega \right)$ & Fourier transform (angular frequency) of $i_a \left( t \right)$ &  \\
$I_a \left( jf \right)$ & Fourier transform (linear frequency) of $i_a \left( t \right)$ & A/Hz \\

& & \\ % Gap
\multicolumn{3}{l}{\textbf{Error Evaluation}} \\
$e \left( s \right)$ & Error function & A \\
$e' \left( t \right)$ & First time derivative of $e \left( t \right)$ & A/s \\

% Symbol & Name & Unit \\

% & & \\ % Gap to separate the Roman symbols from the Greek

% $\omega$ & angular frequency & rads$^{-1}$ \\
% Symbol & Name & Unit \\
}

%----------------------------------------------------------------------------------------
%    Nomenclature
%----------------------------------------------------------------------------------------

\clearpage % Start a new page

\lhead{\emph{Nomenclature}} % Set the left side page header to "Abbreviations"
\printglossary[title=Nomenclature]


%----------------------------------------------------------------------------------------
%	DEDICATION
%----------------------------------------------------------------------------------------

\clearpage

\setstretch{1.3} % Return the line spacing back to 1.3

\pagestyle{empty} % Page style needs to be empty for this page

\dedicatory{To my loving parents\\
for their endless support\\
and belief in me.
\vspace{2em}

\textcyr{\textit{Moe{\u i} SHurochke,\\
za lyubov\cprime~i podderzhku}}

% \textcyr{Privet SHurochka\\
% a b v g d e \"e zh z i\\ {\u i} k l m n o p r s t\\ u f kh c ts
% shch ch sh y yu\\ ya
% \Eoborotnoye~
% \eoborotnoye~
% \cprime~
% \cdprime~
% }
}
 % Dedication text

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - CHAPTERS
%----------------------------------------------------------------------------------------

\mainmatter % Begin numeric (1,2,3...) page numbering

\pagestyle{fancy} % Return the page headers back to the "fancy" style

% Include the chapters of the thesis as separate files from the Chapters folder
% Uncomment the lines as you write the chapters

\glsresetall
\input{./Chapters/ChapterIntro}
\input{./Chapters/ChapterApproach}
\input{./Chapters/ChapterBackground}
\input{./Chapters/ChapterApprox}
\input{./Chapters/ChapterResults}
% \input{./Chapters/ChapterApplication}
\input{./Chapters/ChapterDiscussion}
\input{./Chapters/ChapterConclusion}
\clearpage

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - APPENDICES
%----------------------------------------------------------------------------------------

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

\appendix % Cue to tell LaTeX that the following 'chapters' are Appendices

% Include the appendices of the thesis as separate files from the Appendices folder
% Uncomment the lines as you write the Appendices

\input{./Appendices/AppendixDevelopment}
% \input{./Appendices/AppendixMath}
\input{./Appendices/AppendixICLP}

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

\backmatter

%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------

\label{Bibliography}

\lhead{\emph{References}} % Change the page header to say "Bibliography"

\bibliographystyle{IEEEtranN} % Use the "unsrtnat" BibTeX style for formatting the Bibliography
% \nocite{*}
\bibliography{Bibliographies/Bibliography} % The references (bibliography) information are stored in the file named "Bibliography.bib"

\lhead{\emph{Bibliography}}

\bibliographystylebib{apa}

\makeatletter
\def\@biblabel#1{\hspace*{-\labelsep}}
\makeatother

\bibliographybib{Bibliographies/Bibliography}
\nocitebib{*}

\end{document}
